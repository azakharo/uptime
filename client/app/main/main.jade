#main-page.w100.vh100
  span(us-spinner="{radius:30, width:8, length: 16}", spinner-on="isGettingData")
  #header
    #header-text Uptime Monitor
    #header-right-part.plr1
      // Navi menu
      .btn-group.mr1(uib-dropdown='')
        button#navi-menu-button.btn.btn-primary(type='button', uib-dropdown-toggle='', ng-disabled='disabled')
          span Перейти к&nbsp;&nbsp;
          span.caret
        ul(uib-dropdown-menu='', role='menu', aria-labelledby='navi-menu-button')
          li(role='menuitem', ng-repeat="menuItem in naviMenuItems")
            a(ng-href='{{menuItem.url}}') {{menuItem.name}}
      #user-section.text-right(ng-show="Auth.getCurrentUser() !== undefined")
        span.mr2 Оператор: {{ Auth.getCurrentUser() }}
        button.btn.btn-default.responsive-btn.mr1(ng-click="onSettingsBtnClick()", disabled="disabled")
          i.fa.fa-cog
        button.btn.btn-default.responsive-btn(ng-click="onLogOutBtnClick()")
          i.fa.fa-sign-out
  #content
    #left-part.p1
      #time-period-selector.pb1
        .Grid.Grid--center
          .Grid-cell--autoSize.fs-medium Выбор периода наблюдения:
          .Grid-cell--autoSize.pl1
            // date picker input (dummy)
            input#timeline-datepicker-input(type='text',
            uib-datepicker-popup='{{dateFormat}}', ng-model='dt',
            is-open='isDatePickerOpened', datepicker-options='dateOptions', max-date='today',
            alt-input-formats="altInputFormats")
            // date picker button
            button#timeline-datepicker-btn.btn.btn-default.responsive-btn(type='button',
            ng-click='isDatePickerOpened = true',
            uib-tooltip="Выбрать дату", tooltip-append-to-body="true", tooltip-placement="auto bottom")
              i.glyphicon.glyphicon-calendar
          .Grid-cell--autoSize.pl1
            button.btn.btn-default.responsive-btn(ng-click="onRefreshBtnClick()",
            uib-tooltip="Обновить данные", tooltip-append-to-body="true", tooltip-placement="auto right")
              i.fa.fa-refresh
      //#transport-list-title.pt2.pb1.fs-medium Список транспортных средств с оборудованием:
      #transport-list.overflow-auto
        uib-accordion
          // ACCORDION ITEM
          uib-accordion-group(ng-repeat="bus in busInfos", is-open="accordionItemOpenStates[bus.busName]")
            // HEADER
            uib-accordion-heading
              .Grid.Grid--center(ng-click="onAccordionItemClicked(bus)")
                .Grid-cell--autoSize.accordion-first-col
                  .Grid.Grid--center
                    .Grid-cell--autoSize.rounded(ng-switch="bus.busType",
                    ng-class="getStatusBgClass(bus.status)")
                      img.bus-img(ng-switch-when="trolleybus", src='assets/images/trolleybus.png', alt="Троллейбус")
                      img.bus-img(ng-switch-when="bus",        src='assets/images/bus.png',        alt="Автобус")
                    .Grid-cell.text-right.pr1
                      span.bold(ng-class="getStatusFgClass(bus.status)") {{bus.busName}}
                .Grid-cell
                  timeline(dt-start="dtStart", dt-end="dtEnd", intervals="intervals[bus.busName].busIntervals",
                  height="3rem")
            // BODY
            // validators
            .sect-validators.mb1.bb1
              .accordion-first-col.text-right.bold.pb1 Валидаторы:
              .Grid.Grid--center.pb1(ng-repeat="v in bus.validators")
                .Grid-cell--autoSize.accordion-first-col.text-right.pr1
                  span.bold(ng-class="getStatusFgClass(bus.validatorStatuses[v])") {{v}}
                .Grid-cell
                  timeline(dt-start="dtStart", dt-end="dtEnd", intervals="intervals[bus.busName].validatorIntervals[v]")
            // pps
            .sect-pps.mb1.bb1
              .accordion-first-col.text-right.bold.pb1 Датчики ПП:
              .Grid.Grid--center.pb1(ng-repeat="pp in bus.pp")
                .Grid-cell--autoSize.accordion-first-col.text-right.pr1
                  span.bold(ng-class="getStatusFgClass(bus.ppStatuses[pp])") {{pp | ppNameFilter}}
                .Grid-cell
                  timeline(dt-start="dtStart", dt-end="dtEnd", intervals="intervals[bus.busName].ppIntervals[pp]")
            // GPS
            .sect-gps.pb2
              .Grid.Grid--center
                .Grid-cell--autoSize.accordion-first-col.text-right.pr1
                  span.bold(ng-class="getStatusFgClass(bus.gpsStatus)") GPS
                .Grid-cell
                  timeline(dt-start="dtStart", dt-end="dtEnd", intervals="intervals[bus.busName].gpsIntervals")
    #right-part.p1
      #bus-events-title.pb1.fs-large
        span(ng-show="selectedBus") События для {{ selectedBus.busName }}:
        span(ng-show="!selectedBus") Выберите транспортное средство для просмотра событий.
      #bus-events.grid(ui-grid="gridOptions", ui-grid-auto-resize, ui-grid-pagination)
  footer#footer.text-center Copyright &copy; 2015-2016 &mdash;&nbsp;
    a(href="http://sarov-itc.ru/", target="_blank") ИТЦ Система-Саров
    span ,&nbsp;&nbsp;
    a(href="https://www.me-so.ru/", target="_blank") ДЦ "Микрон"
